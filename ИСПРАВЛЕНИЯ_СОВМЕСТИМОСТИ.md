# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

## üìã –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - –ù–∞–π–¥–µ–Ω–æ 17 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –£—è–∑–≤–∏–º–æ—Å—Ç—å | –†–µ—à–µ–Ω–∏–µ |
|-----------|------------|---------|
| **Electron** | 28.1.0 ‚Üí –ù—É–∂–µ–Ω ‚â•35.7.5 (ASAR bypass) | –û–±–Ω–æ–≤–∏—Ç—å –¥–æ 35.7.5+ |
| **body-parser** | DoS —É—è–∑–≤–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ Express 5.1.0 | –ü–æ–Ω–∏–∑–∏—Ç—å Express –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å body-parser |
| **sqlite3** | –£—è–∑–≤–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ tar ‚â§7.5.3 | –û–±–Ω–æ–≤–∏—Ç—å tar –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö |
| **qs** | DoS —á–µ—Ä–µ–∑ array limit bypass | –û–±–Ω–æ–≤–∏—Ç—å –¥–æ 6.14.1+ |
| **jws** | HMAC signature bypass | –û–±–Ω–æ–≤–∏—Ç—å –¥–æ 3.2.3+ |

---

## ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
npm run fix

# –ò–ª–∏ –±–æ–ª–µ–µ –ø–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
npm run recovery
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º

```bash
# 1. –û—á–∏—Å—Ç–∫–∞
npm cache clean --force
rm -rf node_modules package-lock.json
rm -rf frontend/node_modules frontend/package-lock.json

# 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
npm install electron@latest --save-dev
npm install express@4.21.2 --save  # –í—Ä–µ–º–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
npm audit fix --force

# 3. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install --legacy-peer-deps
cd frontend && npm install && cd ..

# 4. –ö–æ–º–ø–∏–ª—è—Ü–∏—è
npm run build:safe
```

---

## üì¶ –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Electron —É—Å—Ç–∞—Ä–µ–ª (28.1.0 ‚Üí 35.7.5+)

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:** ASAR Integrity Bypass

**–†–µ—à–µ–Ω–∏–µ:**

```bash
npm install electron@latest --save-dev
```

**–ò–ª–∏ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é –≤ package.json:**

```json
{
  "devDependencies": {
    "electron": "^35.7.5"
  }
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
npm list electron
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Express 5.1.0 + body-parser DoS

**–ü—Ä–∏—á–∏–Ω–∞:** Express 5.1.0 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç body-parser 2.2.0 —Å —É—è–∑–≤–∏–º–æ—Å—Ç—å—é DoS

**–†–µ—à–µ–Ω–∏–µ A (–æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ Express 4.x):**

```json
{
  "dependencies": {
    "express": "^4.21.2"
  }
}
```

**–†–µ—à–µ–Ω–∏–µ B (–æ—Å—Ç–∞—Ç—å—Å—è –Ω–∞ Express 5.x –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å body-parser):**

```bash
npm install body-parser@latest --save
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
npm list body-parser
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: sqlite3 + tar —É—è–∑–≤–∏–º–æ—Å—Ç–∏

**–ü—Ä–∏—á–∏–Ω–∞:** sqlite3 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç node-gyp, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—è–∑–≤–∏–º–æ–≥–æ tar

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –û–±–Ω–æ–≤–∏—Ç—å tar –≥–ª–æ–±–∞–ª—å–Ω–æ
npm install -g tar@latest

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å sqlite3
npm uninstall sqlite3
npm install sqlite3@latest --save-optional

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å better-sqlite3 (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
npm install better-sqlite3 --save-optional
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: TypeScript –≤–µ—Ä—Å–∏–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç

**Root:** TypeScript 5.7.2
**Frontend:** TypeScript 5.5.3

**–†–µ—à–µ–Ω–∏–µ - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å:**

```bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
npm install typescript@5.7.2 --save-dev

# –í frontend
cd frontend
npm install typescript@5.7.2 --save-dev
cd ..
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 5: ESLint –≤–µ—Ä—Å–∏–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç

**Root:** ESLint 9.17.0
**Frontend:** ESLint 8.57.0

**–†–µ—à–µ–Ω–∏–µ - –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –µ–¥–∏–Ω–æ–π –≤–µ—Ä—Å–∏–∏:**

```bash
# –í–∞—Ä–∏–∞–Ω—Ç A: –û–±–Ω–æ–≤–∏—Ç—å frontend –¥–æ ESLint 9.x
cd frontend
npm install eslint@9.17.0 \
  @typescript-eslint/parser@8.18.2 \
  @typescript-eslint/eslint-plugin@8.18.2 \
  --save-dev
cd ..

# –í–∞—Ä–∏–∞–Ω—Ç B: –û—Ç–∫–∞—Ç–∏—Ç—å root –¥–æ ESLint 8.x (–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ)
npm install eslint@8.57.0 \
  @typescript-eslint/parser@7.13.1 \
  @typescript-eslint/eslint-plugin@7.13.1 \
  --save-dev
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 6: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ Puppeteer + Playwright

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±–∞ –ø–∞–∫–µ—Ç–∞ —Å–∫–∞—á–∏–≤–∞—é—Ç Chromium (~300 MB –ª–∏—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö)

**–†–µ—à–µ–Ω–∏–µ - –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω:**

#### –í–∞—Ä–∏–∞–Ω—Ç A: –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ Puppeteer (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
npm uninstall playwright playwright-extra
```

**–û–±–Ω–æ–≤–∏—Ç—å package.json:**
```json
{
  "dependencies": {
    "puppeteer": "^23.10.4",
    "puppeteer-extra": "^3.3.6",
    "puppeteer-extra-plugin-stealth": "^2.11.2"
  }
}
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ Playwright

```bash
npm uninstall puppeteer puppeteer-extra puppeteer-extra-plugin-stealth
```

**–û–±–Ω–æ–≤–∏—Ç—å package.json:**
```json
{
  "dependencies": {
    "playwright": "^1.48.0",
    "playwright-extra": "^4.3.6"
  }
}
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 7: faker —É—Å—Ç–∞—Ä–µ–ª (5.5.3 ‚Üí 6.6.6)

**–†–µ—à–µ–Ω–∏–µ:**

```bash
npm install @faker-js/faker@latest --save
npm uninstall faker
```

**–û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ –∫–æ–¥–µ:**

```typescript
// –°—Ç–∞—Ä—ã–π –∫–æ–¥
import faker from 'faker';

// –ù–æ–≤—ã–π –∫–æ–¥
import { faker } from '@faker-js/faker';
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 8: –î—Ä—É–≥–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (js-yaml, lodash, qs)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```bash
npm audit fix
```

**–ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ:**

```bash
npm audit fix --force
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
npm audit
```

---

## üîß –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `FIX_COMPATIBILITY.bat`:

```batch
@echo off
echo –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏...
echo.

echo [1/5] –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞...
call npm cache clean --force

echo [2/5] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–∞–∫–µ—Ç–æ–≤...
call npm install electron@latest --save-dev
call npm install express@4.21.2 --save
call npm install typescript@5.7.2 --save-dev
call npm install @faker-js/faker@latest --save
call npm uninstall faker

echo [3/5] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π...
call npm audit fix

echo [4/5] –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
call npm install --legacy-peer-deps

echo [5/5] –ö–æ–º–ø–∏–ª—è—Ü–∏—è...
call npm run build:safe

echo.
echo –ì–æ—Ç–æ–≤–æ! –ü—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.
pause
```

**–ó–∞–ø—É—Å–∫:**
```bash
FIX_COMPATIBILITY.bat
```

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):

1. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å Electron –¥–æ 35.7.5+
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å Express/body-parser DoS
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å sqlite3 –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å better-sqlite3

### üü† –í–∞–∂–Ω—ã–µ (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):

4. ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å TypeScript –≤–µ—Ä—Å–∏–∏
5. ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å ESLint –≤–µ—Ä—Å–∏–∏
6. ‚úÖ –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–π browser engine

### üü° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ (–ü–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏):

7. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å faker
8. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å npm audit fix
9. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä node_modules

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π
node --version          # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å v20+
npm --version           # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å v10+

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
npm list electron       # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å ‚â•35.7.5
npm list express        # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 4.21.2 –∏–ª–∏ 5.x —Å body-parser fix
npm list typescript     # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤ root –∏ frontend

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
npm audit              # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 0 critical, 0 high

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏
npm run build          # –î–æ–ª–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
npm run typecheck      # –î–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–æ–≤

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞
npm run server         # –î–æ–ª–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è package.json (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è)

```json
{
  "dependencies": {
    "express": "^4.21.2",
    "puppeteer": "^23.10.4",
    "puppeteer-extra": "^3.3.6",
    "puppeteer-extra-plugin-stealth": "^2.11.2",
    "@faker-js/faker": "^9.3.0",
    "electron-store": "^8.1.0",
    "cors": "^2.8.5",
    "dotenv": "^16.4.5",
    "helmet": "^8.1.0",
    "ioredis": "^5.9.2",
    "socket.io": "^4.8.1",
    "uuid": "^13.0.0"
  },
  "devDependencies": {
    "electron": "^35.7.5",
    "electron-builder": "^25.1.8",
    "typescript": "^5.7.2",
    "eslint": "^9.17.0",
    "@typescript-eslint/parser": "^8.18.2",
    "@typescript-eslint/eslint-plugin": "^8.18.2",
    "jest": "^29.7.0",
    "ts-jest": "^29.2.5",
    "prettier": "^3.4.2"
  },
  "optionalDependencies": {
    "better-sqlite3": "^11.7.0"
  }
}
```

---

## üöÄ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

```bash
# 1. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install --legacy-peer-deps

# 2. –ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å
npm run build

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
npm run server

# 4. –°–æ–∑–¥–∞—Ç—å exe-–∏–Ω—Å—Ç–∞–ª–ª–µ—Ä
# –°–º. —Ñ–∞–π–ª –°–û–ó–î–ê–ù–ò–ï_EXE_–ò–ù–°–¢–ê–õ–õ–ï–†–ê.md
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –£–¥–∞–ª–∏—Ç–µ `node_modules` –∏ `package-lock.json`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm install --legacy-peer-deps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –ø–∞–ø–∫–µ `logs/`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run doctor` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

**–°—Ç–∞—Ç—É—Å:** –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2024-01-24
