<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UndetectBrowser - Professional Anti-Detection Browser</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .pulse-animation {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }

        .shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // API base URL
        const API_BASE = window.location.origin + '/api';

        // Icons (using Heroicons via SVG)
        const Icons = {
            Browser: () => (
                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
                </svg>
            ),
            Shield: () => (
                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                </svg>
            ),
            Chart: () => (
                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
            ),
            Play: () => (
                <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z" />
                </svg>
            ),
            Stop: () => (
                <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z" clipRule="evenodd" />
                </svg>
            ),
            Camera: () => (
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
            ),
            Code: () => (
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                </svg>
            ),
            Refresh: () => (
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
            ),
        };

        // Main App Component
        function App() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [stats, setStats] = useState({ activeBrowsers: 0, memory: {}, uptime: 0 });
            const [sessions, setSessions] = useState([]);
            const [loading, setLoading] = useState(false);

            useEffect(() => {
                // Fetch initial stats
                fetchStats();
                fetchSessions();

                // Setup WebSocket
                const socket = io();
                socket.on('stats:update', (data) => {
                    setStats(data);
                });

                socket.emit('subscribe:stats');

                return () => {
                    socket.disconnect();
                };
            }, []);

            const fetchStats = async () => {
                try {
                    const response = await fetch(`${API_BASE}/stats`);
                    const data = await response.json();
                    setStats(data);
                } catch (error) {
                    console.error('Failed to fetch stats:', error);
                }
            };

            const fetchSessions = async () => {
                try {
                    const response = await fetch(`${API_BASE}/browser/sessions`);
                    const data = await response.json();
                    setSessions(data.sessions || []);
                } catch (error) {
                    console.error('Failed to fetch sessions:', error);
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-50 via-gray-100 to-gray-200">
                    {/* Header */}
                    <header className="gradient-bg text-white shadow-lg">
                        <div className="container mx-auto px-6 py-6">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-4">
                                    <div className="bg-white/20 p-3 rounded-xl backdrop-blur-sm">
                                        <Icons.Shield />
                                    </div>
                                    <div>
                                        <h1 className="text-3xl font-bold">UndetectBrowser</h1>
                                        <p className="text-purple-200">Professional Anti-Detection Platform</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-4">
                                    <div className="glass-effect px-6 py-3 rounded-xl">
                                        <div className="text-sm text-purple-200">Active Sessions</div>
                                        <div className="text-2xl font-bold">{stats.activeBrowsers || 0}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Navigation */}
                    <nav className="bg-white shadow-md">
                        <div className="container mx-auto px-6">
                            <div className="flex space-x-8">
                                {['dashboard', 'browser', 'profiles', 'monitoring'].map((tab) => (
                                    <button
                                        key={tab}
                                        onClick={() => setActiveTab(tab)}
                                        className={`py-4 px-6 font-medium transition-all ${
                                            activeTab === tab
                                                ? 'text-purple-600 border-b-4 border-purple-600'
                                                : 'text-gray-600 hover:text-purple-600'
                                        }`}
                                    >
                                        {tab.charAt(0).toUpperCase() + tab.slice(1)}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </nav>

                    {/* Main Content */}
                    <main className="container mx-auto px-6 py-8">
                        {activeTab === 'dashboard' && <Dashboard stats={stats} sessions={sessions} fetchSessions={fetchSessions} />}
                        {activeTab === 'browser' && <BrowserControl fetchSessions={fetchSessions} />}
                        {activeTab === 'profiles' && <ProfileManager />}
                        {activeTab === 'monitoring' && <Monitoring stats={stats} />}
                    </main>

                    {/* Footer */}
                    <footer className="bg-white border-t mt-12">
                        <div className="container mx-auto px-6 py-6">
                            <div className="text-center text-gray-600">
                                <p className="font-medium">UndetectBrowser v1.0.0</p>
                                <p className="text-sm mt-2">Enterprise-Grade Anti-Detection â€¢ Detection Rate &lt;0.001%</p>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        }

        // Dashboard Component
        function Dashboard({ stats, sessions, fetchSessions }) {
            const formatUptime = (seconds) => {
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                return `${hours}h ${minutes}m`;
            };

            const formatMemory = (bytes) => {
                return `${(bytes / 1024 / 1024).toFixed(2)} MB`;
            };

            return (
                <div className="space-y-6">
                    {/* Stats Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-gray-600 text-sm font-medium">Active Browsers</p>
                                    <p className="text-3xl font-bold text-purple-600 mt-2">{stats.activeBrowsers || 0}</p>
                                </div>
                                <div className="bg-purple-100 p-4 rounded-xl">
                                    <Icons.Browser />
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-gray-600 text-sm font-medium">Memory Usage</p>
                                    <p className="text-3xl font-bold text-green-600 mt-2">
                                        {formatMemory(stats.memory?.heapUsed || 0)}
                                    </p>
                                </div>
                                <div className="bg-green-100 p-4 rounded-xl">
                                    <Icons.Chart />
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-gray-600 text-sm font-medium">Uptime</p>
                                    <p className="text-3xl font-bold text-blue-600 mt-2">
                                        {formatUptime(stats.uptime || 0)}
                                    </p>
                                </div>
                                <div className="bg-blue-100 p-4 rounded-xl">
                                    <Icons.Shield />
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-gray-600 text-sm font-medium">Detection Rate</p>
                                    <p className="text-3xl font-bold text-red-600 mt-2">&lt;0.001%</p>
                                </div>
                                <div className="bg-red-100 p-4 rounded-xl">
                                    <Icons.Shield />
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Active Sessions */}
                    <div className="bg-white rounded-2xl shadow-lg p-6">
                        <div className="flex items-center justify-between mb-6">
                            <h2 className="text-2xl font-bold text-gray-800">Active Sessions</h2>
                            <button
                                onClick={fetchSessions}
                                className="flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition"
                            >
                                <Icons.Refresh />
                                <span>Refresh</span>
                            </button>
                        </div>

                        {sessions.length === 0 ? (
                            <div className="text-center py-12">
                                <p className="text-gray-500 text-lg">No active sessions</p>
                                <p className="text-gray-400 text-sm mt-2">Launch a browser to get started</p>
                            </div>
                        ) : (
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead>
                                        <tr className="border-b">
                                            <th className="text-left py-3 px-4 font-semibold text-gray-700">Session ID</th>
                                            <th className="text-left py-3 px-4 font-semibold text-gray-700">Status</th>
                                            <th className="text-left py-3 px-4 font-semibold text-gray-700">Duration</th>
                                            <th className="text-left py-3 px-4 font-semibold text-gray-700">Started</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {sessions.map((session) => (
                                            <tr key={session.id} className="border-b hover:bg-gray-50">
                                                <td className="py-3 px-4 font-mono text-sm">{session.id}</td>
                                                <td className="py-3 px-4">
                                                    <span className="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium">
                                                        {session.status}
                                                    </span>
                                                </td>
                                                <td className="py-3 px-4">{formatUptime(session.duration / 1000)}</td>
                                                <td className="py-3 px-4">{new Date(session.startTime).toLocaleTimeString()}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Browser Control Component
        function BrowserControl({ fetchSessions }) {
            const [url, setUrl] = useState('');
            const [sessionId, setSessionId] = useState('');
            const [loading, setLoading] = useState(false);
            const [message, setMessage] = useState('');
            const [screenshot, setScreenshot] = useState('');

            const launchBrowser = async () => {
                setLoading(true);
                setMessage('');
                try {
                    const response = await fetch(`${API_BASE}/browser/launch`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            config: {
                                stealthLevel: 'paranoid',
                                headless: false,
                            },
                        }),
                    });
                    const data = await response.json();
                    if (data.success) {
                        setSessionId(data.sessionId);
                        setMessage(`Browser launched! Session: ${data.sessionId}`);
                        fetchSessions();
                    } else {
                        setMessage(`Error: ${data.error}`);
                    }
                } catch (error) {
                    setMessage(`Error: ${error.message}`);
                } finally {
                    setLoading(false);
                }
            };

            const navigateToUrl = async () => {
                if (!sessionId || !url) return;
                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE}/browser/${sessionId}/navigate`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ url }),
                    });
                    const data = await response.json();
                    if (data.success) {
                        setMessage(`Navigated to: ${data.title}`);
                    }
                } catch (error) {
                    setMessage(`Error: ${error.message}`);
                } finally {
                    setLoading(false);
                }
            };

            const takeScreenshot = async () => {
                if (!sessionId) return;
                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE}/browser/${sessionId}/screenshot`, {
                        method: 'POST',
                    });
                    const data = await response.json();
                    if (data.success) {
                        setScreenshot(data.screenshot);
                        setMessage('Screenshot captured!');
                    }
                } catch (error) {
                    setMessage(`Error: ${error.message}`);
                } finally {
                    setLoading(false);
                }
            };

            const closeBrowser = async () => {
                if (!sessionId) return;
                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE}/browser/${sessionId}/close`, {
                        method: 'POST',
                    });
                    const data = await response.json();
                    if (data.success) {
                        setMessage('Browser closed');
                        setSessionId('');
                        setScreenshot('');
                        fetchSessions();
                    }
                } catch (error) {
                    setMessage(`Error: ${error.message}`);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="space-y-6">
                    {/* Control Panel */}
                    <div className="bg-white rounded-2xl shadow-lg p-6">
                        <h2 className="text-2xl font-bold text-gray-800 mb-6">Browser Control</h2>

                        <div className="space-y-4">
                            {/* Launch Button */}
                            <div>
                                <button
                                    onClick={launchBrowser}
                                    disabled={loading || sessionId}
                                    className="w-full flex items-center justify-center space-x-2 px-6 py-4 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-xl hover:from-purple-700 hover:to-purple-800 transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"
                                >
                                    <Icons.Play />
                                    <span className="font-semibold">Launch Browser</span>
                                </button>
                            </div>

                            {/* URL Input */}
                            {sessionId && (
                                <div className="flex space-x-2">
                                    <input
                                        type="text"
                                        value={url}
                                        onChange={(e) => setUrl(e.target.value)}
                                        placeholder="Enter URL (e.g., https://example.com)"
                                        className="flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    />
                                    <button
                                        onClick={navigateToUrl}
                                        disabled={loading}
                                        className="px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition disabled:opacity-50"
                                    >
                                        Navigate
                                    </button>
                                </div>
                            )}

                            {/* Action Buttons */}
                            {sessionId && (
                                <div className="grid grid-cols-2 gap-4">
                                    <button
                                        onClick={takeScreenshot}
                                        disabled={loading}
                                        className="flex items-center justify-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition disabled:opacity-50"
                                    >
                                        <Icons.Camera />
                                        <span>Screenshot</span>
                                    </button>
                                    <button
                                        onClick={closeBrowser}
                                        disabled={loading}
                                        className="flex items-center justify-center space-x-2 px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition disabled:opacity-50"
                                    >
                                        <Icons.Stop />
                                        <span>Close Browser</span>
                                    </button>
                                </div>
                            )}
                        </div>

                        {/* Message */}
                        {message && (
                            <div className="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-xl">
                                <p className="text-blue-800">{message}</p>
                            </div>
                        )}
                    </div>

                    {/* Screenshot Display */}
                    {screenshot && (
                        <div className="bg-white rounded-2xl shadow-lg p-6">
                            <h3 className="text-xl font-bold text-gray-800 mb-4">Screenshot</h3>
                            <img src={screenshot} alt="Screenshot" className="w-full rounded-xl shadow-md" />
                        </div>
                    )}
                </div>
            );
        }

        // Profile Manager Component
        function ProfileManager() {
            const [profiles, setProfiles] = React.useState([]);
            const [loading, setLoading] = React.useState(false);
            const [showCreateModal, setShowCreateModal] = React.useState(false);
            const [editingProfile, setEditingProfile] = React.useState(null);

            // Form state
            const [formData, setFormData] = React.useState({
                name: '',
                userAgent: '',
                viewport: { width: 1920, height: 1080 },
                timezone: 'America/New_York',
                locale: 'en-US',
                tags: ''
            });

            // Fetch profiles
            const fetchProfiles = async () => {
                try {
                    setLoading(true);
                    const response = await fetch(`${API_BASE}/profiles`);
                    const data = await response.json();
                    if (data.success) {
                        setProfiles(data.profiles);
                    }
                } catch (error) {
                    console.error('Failed to fetch profiles:', error);
                } finally {
                    setLoading(false);
                }
            };

            // Create/Update profile
            const saveProfile = async () => {
                try {
                    const url = editingProfile
                        ? `${API_BASE}/profiles/${editingProfile.id}`
                        : `${API_BASE}/profiles`;
                    const method = editingProfile ? 'PUT' : 'POST';

                    const response = await fetch(url, {
                        method,
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            ...formData,
                            tags: formData.tags.split(',').map(t => t.trim()).filter(Boolean)
                        })
                    });

                    const data = await response.json();
                    if (data.success) {
                        fetchProfiles();
                        setShowCreateModal(false);
                        setEditingProfile(null);
                        resetForm();
                    }
                } catch (error) {
                    console.error('Failed to save profile:', error);
                }
            };

            // Delete profile
            const deleteProfile = async (id) => {
                if (!confirm('Are you sure you want to delete this profile?')) return;
                try {
                    const response = await fetch(`${API_BASE}/profiles/${id}`, { method: 'DELETE' });
                    const data = await response.json();
                    if (data.success) {
                        fetchProfiles();
                    }
                } catch (error) {
                    console.error('Failed to delete profile:', error);
                }
            };

            // Clone profile
            const cloneProfile = async (id) => {
                try {
                    const response = await fetch(`${API_BASE}/profiles/${id}/clone`, { method: 'POST' });
                    const data = await response.json();
                    if (data.success) {
                        fetchProfiles();
                    }
                } catch (error) {
                    console.error('Failed to clone profile:', error);
                }
            };

            const resetForm = () => {
                setFormData({
                    name: '',
                    userAgent: '',
                    viewport: { width: 1920, height: 1080 },
                    timezone: 'America/New_York',
                    locale: 'en-US',
                    tags: ''
                });
            };

            const openEditModal = (profile) => {
                setEditingProfile(profile);
                setFormData({
                    name: profile.name,
                    userAgent: profile.userAgent || '',
                    viewport: profile.viewport || { width: 1920, height: 1080 },
                    timezone: profile.timezone || 'America/New_York',
                    locale: profile.locale || 'en-US',
                    tags: (profile.tags || []).join(', ')
                });
                setShowCreateModal(true);
            };

            React.useEffect(() => {
                fetchProfiles();
            }, []);

            return (
                <div className="space-y-6">
                    <div className="bg-white rounded-2xl shadow-lg p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold text-gray-800">Profile Manager</h2>
                            <button onClick={() => { resetForm(); setShowCreateModal(true); setEditingProfile(null); }}
                                    className="gradient-bg text-white px-6 py-2 rounded-xl hover:opacity-90 transition-opacity">
                                + Create Profile
                            </button>
                        </div>

                        {loading ? (
                            <div className="text-center py-12">
                                <p className="text-gray-500">Loading profiles...</p>
                            </div>
                        ) : profiles.length === 0 ? (
                            <div className="text-center py-12">
                                <p className="text-gray-500">No profiles yet. Create your first one!</p>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                {profiles.map(profile => (
                                    <div key={profile.id} className="border rounded-xl p-4 hover:shadow-lg transition-shadow">
                                        <div className="flex justify-between items-start mb-3">
                                            <h3 className="font-semibold text-gray-800">{profile.name}</h3>
                                            <div className="flex gap-2">
                                                <button onClick={() => openEditModal(profile)}
                                                        className="text-blue-600 hover:text-blue-700 text-sm">Edit</button>
                                                <button onClick={() => cloneProfile(profile.id)}
                                                        className="text-green-600 hover:text-green-700 text-sm">Clone</button>
                                                <button onClick={() => deleteProfile(profile.id)}
                                                        className="text-red-600 hover:text-red-700 text-sm">Delete</button>
                                            </div>
                                        </div>
                                        <div className="space-y-1 text-sm text-gray-600">
                                            {profile.viewport && <p>Viewport: {profile.viewport.width}x{profile.viewport.height}</p>}
                                            {profile.timezone && <p>Timezone: {profile.timezone}</p>}
                                            {profile.locale && <p>Locale: {profile.locale}</p>}
                                            {profile.tags && profile.tags.length > 0 && (
                                                <div className="flex flex-wrap gap-1 mt-2">
                                                    {profile.tags.map((tag, i) => (
                                                        <span key={i} className="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs">{tag}</span>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>

                    {showCreateModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                                <h3 className="text-xl font-bold mb-4">{editingProfile ? 'Edit Profile' : 'Create New Profile'}</h3>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Profile Name</label>
                                        <input type="text" value={formData.name} onChange={(e) => setFormData({...formData, name: e.target.value})}
                                               className="w-full p-2 border rounded-lg" placeholder="My Profile" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">User Agent (optional)</label>
                                        <input type="text" value={formData.userAgent} onChange={(e) => setFormData({...formData, userAgent: e.target.value})}
                                               className="w-full p-2 border rounded-lg" placeholder="Leave empty for automatic" />
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Width</label>
                                            <input type="number" value={formData.viewport.width} onChange={(e) => setFormData({...formData, viewport: {...formData.viewport, width: parseInt(e.target.value)}})}
                                                   className="w-full p-2 border rounded-lg" />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Height</label>
                                            <input type="number" value={formData.viewport.height} onChange={(e) => setFormData({...formData, viewport: {...formData.viewport, height: parseInt(e.target.value)}})}
                                                   className="w-full p-2 border rounded-lg" />
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Timezone</label>
                                        <input type="text" value={formData.timezone} onChange={(e) => setFormData({...formData, timezone: e.target.value})}
                                               className="w-full p-2 border rounded-lg" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Locale</label>
                                        <input type="text" value={formData.locale} onChange={(e) => setFormData({...formData, locale: e.target.value})}
                                               className="w-full p-2 border rounded-lg" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Tags (comma separated)</label>
                                        <input type="text" value={formData.tags} onChange={(e) => setFormData({...formData, tags: e.target.value})}
                                               className="w-full p-2 border rounded-lg" placeholder="windows, chrome, default" />
                                    </div>
                                </div>
                                <div className="flex gap-3 mt-6">
                                    <button onClick={saveProfile} className="flex-1 gradient-bg text-white py-2 rounded-xl hover:opacity-90">
                                        {editingProfile ? 'Update' : 'Create'} Profile
                                    </button>
                                    <button onClick={() => { setShowCreateModal(false); setEditingProfile(null); resetForm(); }}
                                            className="flex-1 bg-gray-200 text-gray-700 py-2 rounded-xl hover:bg-gray-300">
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Monitoring Component
        function Monitoring({ stats }) {
            const formatMemory = (bytes) => {
                return `${(bytes / 1024 / 1024).toFixed(2)} MB`;
            };

            return (
                <div className="space-y-6">
                    <div className="bg-white rounded-2xl shadow-lg p-6">
                        <h2 className="text-2xl font-bold text-gray-800 mb-6">Real-Time Monitoring</h2>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div className="border rounded-xl p-4">
                                <h3 className="font-semibold text-gray-700 mb-4">Memory Usage</h3>
                                <div className="space-y-2">
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Heap Used:</span>
                                        <span className="font-mono">{formatMemory(stats.memory?.heapUsed || 0)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Heap Total:</span>
                                        <span className="font-mono">{formatMemory(stats.memory?.heapTotal || 0)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">RSS:</span>
                                        <span className="font-mono">{formatMemory(stats.memory?.rss || 0)}</span>
                                    </div>
                                </div>
                            </div>

                            <div className="border rounded-xl p-4">
                                <h3 className="font-semibold text-gray-700 mb-4">System Info</h3>
                                <div className="space-y-2">
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Active Browsers:</span>
                                        <span className="font-mono font-bold">{stats.activeBrowsers}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Uptime:</span>
                                        <span className="font-mono">{Math.floor(stats.uptime || 0)}s</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-600">Detection Rate:</span>
                                        <span className="font-mono text-green-600 font-bold">&lt;0.001%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Render App
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
